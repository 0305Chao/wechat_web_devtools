'use strict';var _exports;function init(){const a=require('../../../lib/react.js');require('../../../lib/react-dom.js');const b=require('../../../stores/webviewStores.js'),c=require('../../../cssStr/cssStr.js');require('../../../utils/file.js'),require('../../../weapp/utils/tools');const d=a.createClass({displayName:'PreviewImage',getInitialState:function(){return{urls:[],translateX:0,load:!1,hidden:!0}},componentDidMount:function(){b.on('SEND_AS_SDK',this._handleAssdkCommand)},componentWillUnmount:function(){b.removeListener('SEND_AS_SDK',this._handleAssdkCommand)},_handleAssdkCommand:function(f,g,h){let{args:i}=g;if('previewImage'===f){let j=i.current,k=i.urls||[];j=k.indexOf(j),j=0<=j?j:0,this.callback=h,this.setState({urls:k,translateX:-j*this.props.width,load:!0,hidden:!1}),h({errMsg:'previewImage:ok'})}},hide:function(){this.setState({hidden:!0})},onMouseDown:function(f){this.startX=f.pageX,this.touch=!0,this.lastTranslateX=this.state.translateX},onMouseMove:function(f){if(this.touch){let h=f.pageX-this.startX+this.lastTranslateX;h=Math.min(0,h),h=Math.max((1-this.state.urls.length)*this.props.width,h),this.setState({translateX:h})}},onMouseUp:function(f){this.startX=0,this.touch=!1,this.setState({translateX:parseInt(this.state.translateX/this.props.width-0.5)*this.props.width})},render:function(){let f={width:`${100*this.state.urls.length}%`,transition:'all linear 0.3s',transform:`translate3d(${this.state.translateX}px,0,0)`};return this.state.load?a.createElement('div',{className:'weui-gallery-wrapper',style:this.state.hidden?c.displayNone:{}},a.createElement('div',{className:'simulator-hd'},a.createElement('div',{className:'simulator-hd-back',onClick:this.hide},a.createElement('i',{className:'simulator-hd-back-icon'}),a.createElement('span',{style:{color:'white'}},'\u8FD4\u56DE'))),a.createElement('div',{className:'weui-gallery-body'},a.createElement('div',{className:'weui-gallery',style:f,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseUp:this.onMouseUp,onMouseLeave:this.onMouseUp},this.state.urls.map(g=>{let h=g;return 0<=g.indexOf('wxfile://')&&(h=g.replace('wxfile://','http://wxfile.open.weixin.qq.com/')),a.createElement('div',{className:'weui-gallery__img',style:{backgroundImage:`url("${h}")`}})})))):null}});_exports=d}init(),module.exports=_exports;