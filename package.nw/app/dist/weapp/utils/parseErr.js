'use strict';var _exports;function init(){function a(k,l,m,n){m=0<m?m:1;let o=h(k,l,m);return`${n}\n${o}`}const b=require('path'),c=require('fs'),d=require('../../config/config.js'),f=require('../../lib/jsonlint.js').parser,g=require('../../stores/projectStores.js'),h=require('babel-code-frame');f.parseError=f.lexer.parseError=function(k,l){throw l};const i=d.WXML_ERROR,j=d.WXML_LOSE_ERROR;_exports={},_exports.parseWXMLRuntimeErr=k=>{let l=g.getCurrentProject(),m=k.message.replace(d.WXML_RUNTIME_ERROR,''),n=m.split(':'),o=parseInt(n[2]),p=parseInt(n[3]);if(-1!==o){let q=c.readFileSync(b.join(l.projectpath,n[0]),'utf8'),r=m.replace(`${n[0]}:${n[1]}:${n[2]}:${n[3]}:`,'').replace(/`/g,'"'),s=a(q,o,p,r),t={file:n[0],reason:r,msg:s};return t}},_exports.parseJsFileErr=k=>{let l=k.file.replace(/\.js$/,''),m=k.project,n=JSON.parse(c.readFileSync(b.join(m.projectpath,'app.json'),'utf8')),o=n.pages,p=o.findIndex(q=>{return q==l});return{file:l,msg:` app.json.pages\n > | pages[${p}] : ${o[p]}`}},_exports.parseJsonContentErr=k=>{return{file:k.file,msg:k.data}},_exports.parseJsonEntranceErr=k=>{let l=JSON.parse(k.data),m=l.pages;return{file:k.file,msg:`未找到入口页面\napp.json 中定义的 pages : ${JSON.stringify(m)}`}},_exports.parseJsonFileErr=k=>{return{file:k.file,msg:'\u672A\u627E\u5230\u5165\u53E3 app.json \u6587\u4EF6\uFF0C\u6216\u8005\u6587\u4EF6\u8BFB\u53D6\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u540E\u91CD\u65B0\u7F16\u8BD1\u3002'}},_exports.parseJsonParseErr=k=>{let l=k.data;k.e;try{f.parse(l)}catch(m){let n=`Expecting ${m.expected}, got ${m.token}`,o=a(l,m.line,m.loc.first_column,n);return k.msg=o,delete k.data,delete k.e,k}return k.msg=k.e.toString(),k},_exports.parseWxmlErr=(k,l)=>{let m=(l||'').trim().split(':');try{if(m.length){let n=b.join(k.projectpath,m[0]);c.readFileSync(n,'utf8').split('\n');let o=parseInt(m[1]),p=parseInt(m[2]-1),q=a(c.readFileSync(n,'utf8'),o,p,m[3]),r={file:m[0],msg:q};return`${i}${encodeURIComponent(JSON.stringify(r))}`}}catch(n){return l}},_exports.parseWxmlLoseErr=(k,l)=>{let m=l.match(/(\d.*?)\:/),n=m[1],o=JSON.parse(l.replace(m[0],'')),p=`未找到 ${o.pages[n]}.wxml 文件 \n > ${n} ${o.pages[n]}`;return`${j}${encodeURIComponent(p)}`},_exports.parseWxssErr=k=>{let{msg:l}=k,m=g.getCurrentProject();try{l=l.split('\n')[0];let n=l.match(/ERR:\s(.+)\((\d*):(\d*)\):\s*?(.+)/),o=parseInt(n[2]),p=parseInt(n[3]-1),q=n[4].replace(/`/g,'"'),r=n[1],s=c.readFileSync(b.join(m.projectpath,r),'utf8'),t=a(s,o,p,q);return{file:r,reason:q,msg:t}}catch(n){}}}init(),module.exports=_exports;