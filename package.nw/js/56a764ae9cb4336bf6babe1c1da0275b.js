"use strict";!function(require,directRequire){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const a=require('./46d7303eb986fa402d60bf5e929aa077.js'),b=require('./a148d3a11fd5268109e21fb40c9d527b.js'),c=require("fs"),d=require("path"),e=require("mkdir-p"),f=20,g=()=>{};class h{constructor(a){this.counters={log:0,warn:0,error:0,assertion:0},this.timers={},this.caches={},this.warnCounter=0,this.errorCounter=0,this.assertionCounter=0,this.logFolder=a.logFolder,this.logFileForWarnings=a.logFileForWarnings,this.logFileForErrors=a.logFileForErrors,this.logFileForAssertions=a.logFileForAssertions,e.sync(this.logFolder),this.limitLogFiles.call(this)}limitLogFiles(){const a=this.getProperty("logFolder"),b=c.readdirSync(a),e={log:[],warn:[],error:[],assertion:[]};for(const g of b){const b=d.join(a,g),f=c.statSync(b);g.startsWith("log.")?e.log.push({filePath:b,createTime:parseInt(f.birthtime.getTime()/1e3+"")}):g.startsWith("warn.")?e.warn.push({filePath:b,createTime:parseInt(f.birthtime.getTime()/1e3+"")}):g.startsWith("error.")?e.error.push({filePath:b,createTime:parseInt(f.birthtime.getTime()/1e3+"")}):g.startsWith("assertion.")&&e.assertion.push({filePath:b,createTime:parseInt(f.birthtime.getTime()/1e3+"")})}const g=this.getProperty("counters");for(const a in e){if(!e.hasOwnProperty(a))continue;const b=e[a];if(b.sort((c,a)=>{return c.createTime<a.createTime?1:-1}),b.length>=f){for(let a=f;a<b.length;a++){const d=b[a];try{c.unlinkSync(d.filePath)}catch(a){}}g[a]=f}else g[a]=b.length}}get i(){return a.isDev?console.log.bind(console,a.timeStamp(),this.identifier):g}get w(){return this.logFileForWarnings?(...b)=>{this.logWarn.call(this,...b),console.warn.bind(a.timeStamp(),this.identifier,...b)}:console.warn.bind(console,a.timeStamp(),this.identifier)}get e(){return this.logFileForWarnings?(...b)=>{this.logError.call(this,...b),console.error.bind(a.timeStamp(),this.identifier,...b)}:console.error.bind(console,a.timeStamp(),this.identifier)}get assert(){return this.logFileForWarnings?(...b)=>{this.logAssertion.call(this,...b),console.error.bind(a.timeStamp(),this.identifier,...b)}:console.error.bind(console,a.timeStamp(),this.identifier,"[ASSERTION]")}get f(){return this.logLog.bind(this)}logLog(...b){this.logToFile.call(this,"log",`${this.identifier} ${a.timeStamp()} :: ${b.join(" ")}`)}logWarn(...b){this.logToFile.call(this,"warn",`${this.identifier} ${a.timeStamp()} :: ${b.join(" ")}`)}logError(...b){this.logToFile.call(this,"error",`${this.identifier} ${a.timeStamp()} :: ${b.join(" ")}`)}logAssertion(...b){this.logToFile.call(this,"assertion",`${this.identifier} ${a.timeStamp()} :: ${b.join(" ")}`)}logToFile(a,b){const e=this.getProperty("caches");e[a]=(e[a]||"")+"\n"+b;const f=this.getProperty("timers");f[a]||(f[a]=setTimeout(()=>{f[a]=void 0;const b=this.getProperty("counters"),g=this.getProperty("logFolder"),h=d.join(g,`${a}.${b[a]||0}.txt`);let i="";try{i=c.readFileSync(h,"utf-8")}catch(a){i=""}i+=e[a],e[a]="";try{c.writeFileSync(h,i,"utf-8"),i.length>512000&&(b[a]=Math.min(b[a]+1,1e3))}catch(a){}},5e3))}setProperty(a,b){this[a]=b}getProperty(a){return this[a]}}const i=new h({identifier:"[not provided]",logFolder:b.RemoteLogDir,logFileForWarnings:!0,logFileForErrors:!0,logFileForAssertions:!0}),j=i.getProperty.bind(i),k=i.setProperty.bind(i);exports.default=function(a){const b={identifier:a,setProperty:k,getProperty:j};return Object.setPrototypeOf(b,i),b}}(require("lazyload"),require);