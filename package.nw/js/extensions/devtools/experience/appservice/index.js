(function(b){function c(e){if(d[e])return d[e].exports;var f=d[e]={i:e,l:!1,exports:{}};return b[e].call(f.exports,f,f.exports,c),f.l=!0,f.exports}var d={};return c.m=b,c.c=d,c.i=function(b){return b},c.d=function(b,d,e){c.o(b,d)||Object.defineProperty(b,d,{configurable:!1,enumerable:!0,get:e})},c.n=function(b){var d=b&&b.__esModule?function(){return b['default']}:function(){return b};return c.d(d,'a',d),d},c.o=function(b,c){return Object.prototype.hasOwnProperty.call(b,c)},c.p='',c(c.s=301)})({1:function(b,c,d){const e=d(15).EventEmitter;b.exports=new e},15:function(b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(b){return'function'==typeof b}function e(b){return'number'==typeof b}function f(b){return'object'==typeof b&&null!==b}function g(b){return void 0===b}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(b){if(!e(b)||0>b||isNaN(b))throw TypeError('n must be a positive number');return this._maxListeners=b,this},c.prototype.emit=function(b){var c,e,h,j,k,i;if(this._events||(this._events={}),'error'===b&&(!this._events.error||f(this._events.error)&&!this._events.error.length))if(c=arguments[1],c instanceof Error)throw c;else{var l=new Error('Uncaught, unspecified "error" event. ('+c+')');throw l.context=c,l}if(e=this._events[b],g(e))return!1;if(d(e))switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:j=Array.prototype.slice.call(arguments,1),e.apply(this,j);}else if(f(e))for(j=Array.prototype.slice.call(arguments,1),i=e.slice(),h=i.length,k=0;k<h;k++)i[k].apply(this,j);return!0},c.prototype.addListener=function(b,e){var h;if(!d(e))throw TypeError('listener must be a function');return this._events||(this._events={}),this._events.newListener&&this.emit('newListener',b,d(e.listener)?e.listener:e),this._events[b]?f(this._events[b])?this._events[b].push(e):this._events[b]=[this._events[b],e]:this._events[b]=e,f(this._events[b])&&!this._events[b].warned&&(h=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,h&&0<h&&this._events[b].length>h&&(this._events[b].warned=!0,console.error('(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.',this._events[b].length),'function'==typeof console.trace&&console.trace())),this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(b,c){function e(){this.removeListener(b,e),f||(f=!0,c.apply(this,arguments))}if(!d(c))throw TypeError('listener must be a function');var f=!1;return e.listener=c,this.on(b,e),this},c.prototype.removeListener=function(b,c){var e,g,h,j;if(!d(c))throw TypeError('listener must be a function');if(!this._events||!this._events[b])return this;if(e=this._events[b],h=e.length,g=-1,e===c||d(e.listener)&&e.listener===c)delete this._events[b],this._events.removeListener&&this.emit('removeListener',b,c);else if(f(e)){for(j=h;0<j--;)if(e[j]===c||e[j].listener&&e[j].listener===c){g=j;break}if(0>g)return this;1===e.length?(e.length=0,delete this._events[b]):e.splice(g,1),this._events.removeListener&&this.emit('removeListener',b,c)}return this},c.prototype.removeAllListeners=function(b){var c,e;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[b]&&delete this._events[b],this;if(0===arguments.length){for(c in this._events)'removeListener'!==c&&this.removeAllListeners(c);return this.removeAllListeners('removeListener'),this._events={},this}if(e=this._events[b],d(e))this.removeListener(b,e);else if(e)for(;e.length;)this.removeListener(b,e[e.length-1]);return delete this._events[b],this},c.prototype.listeners=function(b){var c;return c=this._events&&this._events[b]?d(this._events[b])?[this._events[b]]:this._events[b].slice():[],c},c.prototype.listenerCount=function(b){if(this._events){var c=this._events[b];if(d(c))return 1;if(c)return c.length}return 0},c.listenerCount=function(b,c){return b.listenerCount(c)}},2:function(b,c,d){const e=d(4);b.exports.$=function(b,c){return'string'==typeof c&&(c=document.querySelector(c)),(c||document).querySelector(b)},b.exports.$$=function(b){return document.querySelectorAll(b)},b.exports.show=function(b){'string'==typeof b&&(b=document.querySelector(b)),b.style.display=''},b.exports.hide=function(b){'string'==typeof b&&(b=document.querySelector(b)),b.style.display='none'},b.exports.sprintf=function(b,c){for(let d=0;d<c.length;d++)b=b.replace(/%s/,c[d]);return b},b.exports.reportBehavior=function(b){e.send({command:'REPORT',data:JSON.stringify(b)})},b.exports.log=function(){const b=Array.prototype.slice.call(arguments);b.unshift('color: #ea6f5a;'),b.unshift('%c[Audit]'),console.log.apply(console,b)},b.exports.formatSize=function(b){const c=['B','K','M','G'];let d;for(;(d=c.shift())&&1024<b;)b/=1024;return('B'===d?b:b.toFixed(2))+d},b.exports.hash=function(b){let c=5381,d=b.length;for(;d;)c=33*c^b.charCodeAt(--d);return c>>>0},b.exports.byteCount=function(b){return encodeURI(b).split(/%..|./).length-1},b.exports.unique=function(b){var c=[];for(var d in b)-1==c.indexOf(b[d])&&c.push(b[d]);return c},b.exports.status='running'},253:function(b,c,d){function e(b){k.send({command:'TRANSFER',eventName:'wx-request',from:'appservice',data:{url:b,page:__appServiceEngine__.getCurrentRoute()}})}function f(b,c){k.send({command:'TRANSFER',eventName:'wx-request-body',from:'appservice',data:{url:b,body:c,page:__appServiceEngine__.getCurrentRoute()}})}function g(){const b=[];try{a}catch(c){const d=c.stack.split('\n').slice(3);for(let c,e,f=0;f<d.length&&(c=d[f],!(-1<c.indexOf('WAService.js')||-1<c.indexOf('appservice/__dev__')));f++)e=c.match(/at (.+) \(http:\/\//),e&&e[1]&&b.push(e[1])}return b}function h(){const b={};Object.keys(exparser.Component._list).forEach(function(c){!c||'wx://functional-page'===c||/^plugin:\/\//.test(c)||/^plugin-private:\/\//.test(c)||/(^|\/)miniprogram_npm\//g.test(c)||(b[c]=exparser.Component._list[c])}),Object.keys(b).forEach((c)=>{if(!c)return;const d=b[c],e=d.initiator;d.initiator=function(){const b=this,c=b.setData;e.call(b);b.__customConstructor__===__virtualDOM__.Page||b.__set_data_rewrited__||(p(this,{setData:{value:function(d,e){if(c.call(b,d,e),'running'!==m.status)return;o(()=>{l.emit('set-data',d,this.is,f)});const f=g()}}}),b.__set_data_rewrited__=!0)}})}function i(){const b=getCurrentPages();b.forEach((b)=>{if(!b||b.__set_data_rewrited__)return;const c=b.setData;p(b,{setData:{value:function(d,e){if(c.call(b,d,e),'running'!==m.status)return;o(function(){l.emit('set-data',d,'Page',f)});const f=g()}}}),b.__set_data_rewrited__=!0})}function j(){const b=wx.request;p(wx,{request:{value:function(c){const d=c.success;c.success=function(b){'function'==typeof d&&d(b),'running'!==m.status||200===b.statusCode&&b.data&&f(c.url,m.hash(JSON.stringify(b.data)))},b(c),'running'!==m.status||e(c.url)}}})}const k=d(6),l=d(1),m=d(2),n=setInterval,o=setTimeout,p=Object.defineProperties;window.__passWAServiceGlobal__=function(b){for(let c in b)window[c]=b[c];if(__wxConfig.plugins)if('undefined'!=typeof __subContextEngine__){const b=__subContextEngine__.initAppRelatedContexts;p(__subContextEngine__,{initAppRelatedContexts:{value:function(c){const d=__wxConfig.onReady;__wxConfig.onReady=function(){},b(c),__wxConfig.onReady=d}}})}else if('undefined'!=typeof __wxConfig){__wxConfig.isIsolateContext=!0;const b=Reporter.reportIDKey;p(Reporter,{reportIDKey:{value:function(c){if('initAppIsolatedContext'===c.key)throw new Error('\u5728\u8FD0\u884C Audits \u7684\u8FC7\u7A0B\u4E2D\uFF0C\u8BF7\u5FFD\u7565\u8BE5\u9519\u8BEF');b(c)}}})}},k.registerCallback((b)=>{let{command:c,eventName:d}=b;'TRANSFER'===c?l.emit(d):void 0}),l.on('stop-audit',function(){m.status='stopped'}),b.exports.init=function(){return'undefined'==typeof __appServiceSDK__?(console.error('\u57FA\u7840\u5E93\u5207\u6362\u5230 2.2.0+ \uFF0C\u624D\u80FD\u4F7F\u7528 Audits \u529F\u80FD'),void k.send({command:'TRANSFER',eventName:'not-supported-wxalib'})):void(__appServiceSDK__.onAppRoute(function(){'running'!==m.status||i()}),i(),h(),j(),d(308).init(),d(318).init(),d(316).init(o),d(320).init(),d(305).init(),d(325).init(o,n),d(329).init())}},301:function(b,c,d){function e(){f.connect('APPSERVICE_EXPERIENCE'),f.registerCallback((b)=>{const{command:c}=b}),g.init()}const f=d(6),g=d(253),h=d(2);'complete'===document.readyState?e():window.addEventListener('load',e)},305:function(b,c,d){function e(b,c){g.send({command:'TRANSFER',eventName:'execute-long-time',from:'appservice',data:{cost:b,extend:c,page:__appServiceEngine__.getCurrentRoute()}})}function f(){const b=Reporter.slowReport;Object.defineProperties(Reporter,{slowReport:{value:function(c){b(c),'running'!==h.status||'pageInvoke'===c.key&&e(c.cost,c.extend)}}})}const g=d(6),h=d(2);b.exports.init=function(){f()}},308:function(b,c,d){function e(b){'running'!==g.status||f.send({command:'TRANSFER',eventName:'js-exception',data:{msg:b,page:__appServiceEngine__.getCurrentRoute()}})}const f=d(6),g=d(2);b.exports.init=function(){Reporter.registerErrorListener(e)}},316:function(b,c,d){function e(b,c,d){g.send({command:'TRANSFER',eventName:'set-data-freq',data:{times:b,page:__appServiceEngine__.getCurrentRoute(),position:c,stack:d.join(' -> ')}})}function f(b,c){clearTimeout(p);for(let d=0,f=o.length;d<f;d++){let g=0,h=d;for(;g<k&&h<f;)g+=o[h],h++;if(g<k)return void(h-d>=m&&(p=n(function(){e(h-d,b,c),o=[]},k-g)));if(h-d>=m){e(h-d,b,c),o=[];break}}}const g=d(6),h=d(1),k=1e3,m=20;let n=setTimeout,o=[],i=Date.now(),p=null;h.on('set-data',function(b,c,d){const e=Date.now(),g=e-i;i=e,g>k?o=[]:o.push(g),o.length>=m&&f(c,d)}),b.exports.init=function(b){n=b}},318:function(b,c,d){function e(b,c,d,e){f.send({command:'TRANSFER',eventName:'set-data-large',data:{size:b,page:__appServiceEngine__.getCurrentRoute(),position:c,stack:d.join(' -> '),vars:e}})}const f=d(6),g=d(1);g.on('set-data',function(b,c,d){const f=JSON.stringify(b).length;f>262144&&e(f,c,d,Object.keys(b))}),b.exports.init=function(){}},320:function(b,c,d){function e(b,c,d){f.send({command:'TRANSFER',eventName:'set-data-no-binding',from:'appservice',data:{vars:b,page:__appServiceEngine__.getCurrentRoute(),position:c,stack:d.join(' -> ')}})}const f=d(6),g=d(1),h=d(2);g.on('set-data',function(b,c,d){e(Object.keys(b),c,d)}),b.exports.init=function(){}},325:function(b,c,d){function e(b,c,d){i.send({command:'TRANSFER',eventName:'timer-no-recycle',from:'appservice',data:{name:c,page:b,path:d}})}function f(){try{foo.bar.foo.bar}catch(b){const c=b.stack.split('\n'),d=c[3];if(-1<d.indexOf('appservice/__asdebug__')||-1<d.indexOf('appservice/__dev__'))return null;const e=d.match(/at (.*) \(([^)]+)\)/);return e?{funcName:e[1],path:e[2]}:null}return null}function g(b,c){const d=function(d,g=0,...h){let i,j,m=__appServiceEngine__.getCurrentRoute();return'running'===k.status&&(Object.defineProperty(d,'name',{writable:!0}),d.name=`Audit_${c}_${m}`,i=f()),b('running'===k.status?function(){if(d.apply(l,h),!!i){const b=__appServiceEngine__.getCurrentRoute(),d=(i.funcName||'').match(/Audit_(setTimeout|setInterval)_(.*)/);d&&d[2]&&(m=d[2]),j=(i.path||'').replace(/^.*\/appservice\/([^:]+).*$/,'$1'),b!==m&&e(m,c,j)}}:d,g)};return Object.defineProperty(d,'name',{writable:!0}),d.name=`Audit_${c}`,d}function h(b,c){setInterval=g(c,'setInterval'),setTimeout=g(b,'setTimeout')}const i=d(6),j=d(1),k=d(2),l=function(){return this}();b.exports.init=function(b,c){h(b,c)}},329:function(b,c,d){const e=d(6),f=d(1),g=d(2);let h=[],i=[],j=[];!__wxConfig||!__wxConfig.tabBar||(j=__wxConfig.tabBar.list.map((b)=>b.pagePath.replace('.html',''))),f.on('stop-audit',function(){let b=[];for(let c of i)b.push(c.route);b=b.concat(h),e.send({command:'TRANSFER',eventName:'page-info',from:'appservice',data:{pages:b}})}),__appServiceSDK__.onAppRoute(()=>{let b=__appServiceEngine__.getCurrentPages();0>h.indexOf(b[0].route)&&-1<j.indexOf(b[0].route)&&h.push(b[0].route),i=b}),b.exports.init=function(){}},4:function(b){function c(b){n=b?b:n;var f=h(q);l=new g(m,`${n}#${f}#`),l.onopen=function(){let b=[].concat(p);p=[],b.forEach((b)=>{d(b)})},l.onclose=function(){l=null,setTimeout(()=>{c(b)},100)},l.onmessage=function(b){try{let c=JSON.parse(b.data);e(c)}catch(b){}}}function d(b){l&&l.readyState===g.OPEN?l.send(JSON.stringify(b)):p.push(b)}function e(){o.forEach((b)=>{try{b.apply(this,arguments)}catch(b){console.error(b)}})}var f=window.navigator||window.__global.navigator,g=window.WebSocket||window.__global.WebSocket,h=window.prompt||window.__global.prompt,i=f.userAgent,j=i.match(/port\/(\d*)/),k=j?parseInt(j[1]):9974,l=null,m=`ws://127.0.0.1:${k}`,n=null,o=[],p=[];const q='GET_MESSAGE_TOKEN';b.exports={connect:c,send:d,registerCallback:(b)=>{o.push(b)},getWs(){return l}}},6:function(b){var c=function(){function b(e){l=e?e:l;var g=window.prompt?prompt('GET_MESSAGE_TOKEN'):__global.prompt('GET_MESSAGE_TOKEN');j=new f(k,`${l}#${g}#`),j.onopen=function(){let b=[].concat(n);n=[],b.forEach((b)=>{c(b)})},j.onclose=function(){j=null,setTimeout(()=>{b(e)})},j.onmessage=function(b){try{let c=JSON.parse(b.data);d(c)}catch(b){}}}function c(b){j&&j.readyState===f.OPEN?j.send(JSON.stringify(b)):n.push(b)}function d(){m.forEach((b)=>{try{b.apply(this,arguments)}catch(b){console.error(b)}})}const e=window.navigator||window.__global.navigator,f=window.WebSocket||window.__global.WebSocket,g=e.userAgent;var h=g.match(/port\/(\d*)/),i=h?parseInt(h[1]):9974,j=null,k=`ws://127.0.0.1:${i}`,l=null,m=[],n=[];return{connect:b,send:c,registerCallback:(b)=>{m.push(b)},getWs(){return j}}}();b.exports=c}});