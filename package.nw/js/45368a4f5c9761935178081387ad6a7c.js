'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};!function(require,directRequire){async function a(a,b,c=''){let d={pages:[],page:{}};if(!b)return d;for(const e in b){let f=b[e],g=await i.getPluginJSON(a,{version:f.version,pluginId:f.provider});if(g.pages)for(const a in g.pages)d.pages.push(`${c}${g.pages[a]}`);if(g.page)for(const a in g.page)d.page[`${c}${a}`]={window:g.page[a]}}return d}const b=require('path'),c=require('./1dea83a77e99a7c94f6b6f01f5c175b0.js'),d=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),e=require('./37be435102276ea9cf47609ff6535cd4.js'),f=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),g=require('./cc2c2970ff81ae4a83123e81ee123da2.js'),h=require('./3bfffbe88b3d923921f851c0697974fe.js'),i=require('./b6d8659542036f6a35f417e0693e56db.js');var j={USER_DATA_PATH:e.USER_DATA_PATH};module.exports=async function(e){let k=await c(e),l=e.attr&&e.attr.setting||{};l=_extends({},d.setting,l);let m=_extends({},k,{wxAppInfo:{maxRequestConcurrent:l.MaxRequestConcurrent,maxUploadConcurrent:l.MaxUploadConcurrent,maxDownloadConcurrent:l.MaxDownloadConcurrent,maxWorkerConcurrent:l.MaxWorkerConcurrent}});if(0==Object.keys(m.plugins).length&&delete m.plugins,k.mainPlugins){let b=await a(e,k.mainPlugins);m.pages=m.pages.concat(b.pages),m.page=_extends({},m.page,b.page)}if(k.subPackages)for(var n=0;n<k.subPackages.length;n++){let c=k.subPackages[n],d=c.pages.map((a)=>{return b.posix.join(c.root,a)});if(m.pages=m.pages.concat(d),c.plugins){let b=await a(e,c.plugins,c.root);m.pages=m.pages.concat(b.pages),m.page=_extends({},m.page,b.page)}}if(m.plugins){let a,b=!1,c=!1;if(e.pluginInfo&&0<e.pluginInfo.length){const a={};for(const b in m.plugins)a[m.plugins[b].provider]=m.plugins[b].version;for(const d of e.pluginInfo){if(!d||!d.current||!d.current.innerVersion){b=!0;break}if(d.current.version!==a[d.appid]){c=!0;break}}}else b=!0;if(b||c)try{const b=await h.getLatestPluginInfo();a=b.map((a)=>{return{plugin_id:a.appid,inner_version:a.current.innerVersion}}),setTimeout(()=>{f.dispatch(g.setPluginInfo(b))})}catch(a){}else a=e.pluginInfo.map((a)=>{return{plugin_id:a.appid,inner_version:a.current.innerVersion}});for(const b in m.plugins)m.plugins[b]&&'dev'===m.plugins[b].version&&(a||(a=[]),a.push({plugin_id:m.plugins[b].provider,inner_version:0}));m.appContactInfo={call_plugin_info:a}}const i=f.getState();let o=i.simulator.appLaunchInfo||{path:m.pages[0],scene:d.SCENE_DEFAULT,query:{}};return m=_extends({},m,{platform:'devtools',appLaunchInfo:o,env:j}),m}}(require('lazyload'),require);